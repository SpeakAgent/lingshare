<!DOCTYPE html>
<!-- saved from url=(0041)http://127.0.0.1:8000/games/flashcards/1/ -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style type="text/css">@charset "UTF-8";[ng\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide{display:none !important;}ng\:form{display:block;}.ng-animate-start{clip:rect(0,auto,auto,0);-ms-zoom:1.0001;}.ng-animate-active{clip:rect(-1px,auto,auto,0);-ms-zoom:1;}</style>
	<!-- CDN this for now -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
    <link href="http://127.0.0.1:8000/media/css/carousel.css" rel="stylesheet">

  

<style>
	img.large-card {
		width: 600px;
		margin: 2em;
		border: 4px darkblue solid;
		border-radius: 10px;
	}

  div.card-container {
    width: 200px;
    height: 130px;
  }

	div.small-card {
		width: 200px;
		height: 130px;
		border: 4px darkblue solid;
		margin: 2em;
		border-radius: 10px;
   		text-align: center;
	}

  div.card-container {
    width: 200px;
    height: 130px;
    margin: 2em;
  }

  div.card-container div img {
    width: 200px;
    height: 130px;
    border: 4px darkblue solid;
    border-radius: 10px;
  }

  div.card-alerts {
    background-color: orange;
    width: 48px;
    height: 48px;
    float: left;
    border-radius: 24px;
    padding: 12px 8px;
  }
</style>




</head>

<body ng-app>
  <div class="container" role="main" ng-controller="FlashCardController">

  <h1>{{ wordlist.title }}</h1>
  <p>{{ wordlist.description }}</p>
  <div class = "cards"
       ng-show="!done">
    <div class="col-md-8">
    <img src="http://127.0.0.1:8000{{ card.base_word.symbol.0.image }}" class="large-card">
    </div>

    <div class="col-md-4">
      <div class="card-container"
           ng-repeat="item in possible_cards"
           ng-click="checkCard(item)">
           <div class="card-alerts animate-show"
                ng-show="alerts[item.base_word.root_word] != null">
          {{ alerts[item.base_word.root_word] }}
        </div>
      	<div class="small-card text-center"
             ng-show="show_symbol != item.base_word.root_word">
          {{ item.base_word.root_word }}
        </div>
        <div ng-show="show_symbol == item.base_word.root_word">
          <img 
            src="http://127.0.0.1:8000{{ item.base_word.symbol.0.image }}">
        </div>
      </div>
    </div>
  </div>
  <div class = "done"
       ng-show = "done">
       <p>Done!</p>
       <p>You clicked correctly {{ actions.right.length }} times.</p>
       <p>You clicked incorrectly {{ actions.wrong.length }} times.</p>
  </div>
  <script src="./media/bootstrap.min.js"></script>
      <script>
    function FlashCardController($scope, $timeout, $http) {

      $scope.used_words = []

      var url = "http://127.0.0.1:8000/wordlists/json/1/"
      $http.get(url)
            .success(function(data){
                        $scope.wordlist = data;
                        $scope.getUnusedWords()
                        $scope.newScreen()
                        $scope.actions = {
                          wrong: [],
                          right: []
                        }
            });

      $scope.alerts = [];

      $scope.show_symbol = null;

      $scope.shuffle = function (array) {
        var m = array.length, t, i;

        // While there remain elements to shuffle…
        while (m) {

          // Pick a remaining element…
          i = Math.floor(Math.random() * m--);

          // And swap it with the current element.
          t = array[m];
          array[m] = array[i];
          array[i] = t;
        }

        return array;
      }

      $scope.getUnusedWords = function () {
        $scope.unused_words = [];
        angular.forEach($scope.wordlist.words, function (word, index) {
          $scope.unused_words.push(word);
        });
        $scope.unused_words = $scope.shuffle($scope.unused_words);
        $scope.words = $scope.wordlist.words;
      }

      $scope.newScreen = function() {
        // Get new word and index of new word
        if ($scope.unused_words.length > 0) {
          $scope.card = $scope.unused_words.pop()
          var indexes = []
          do {
            n = Math.floor(Math.random() * $scope.words.length);
            if (indexes.indexOf(n) < 0 
                && $scope.words[n].base_word.root_word != $scope.card.base_word.root_word) {
               indexes.push(n)}
          } while (indexes.length <= 2)
          // $scope.card = $scope.words[indexes[0]];
          $scope.other_cards = {
            card1 : $scope.words[indexes[1]],
            card2 : $scope.words[indexes[2]]
          }
          $scope.possible_cards = [$scope.other_cards.card1, $scope.other_cards.card2, 
            $scope.card];
          $scope.possible_cards = $scope.shuffle($scope.possible_cards)
        } else {
          $scope.endScreen()
        }
      };

      $scope.endScreen = function () {
        $scope.done = true;
      }


      $scope.checkCard = function (item) {
        // Flip it
        if ($scope.show_symbol == null) {
          // Only do something if we don't have a card flipped
          $scope.show_symbol=item.base_word.root_word;
          // Win or no?
          if (item.base_word.root_word == $scope.card.base_word.root_word) {
            $scope.alerts[item.base_word.root_word] = "That's right!";
            $timeout(function() {
              $scope.alerts[item.base_word.root_word] = null;
              $scope.show_symbol = null;
              $scope.actions.right.push({
                word: $scope.card.base_word.root_word,
                clicked: item.base_word.root_word});
              $scope.newScreen();
            }, 1500);
          } else {
            $scope.alerts[item.base_word.root_word] = "Nope";
            $timeout(function() {
              $scope.alerts[item.base_word.root_word] = null;
              $scope.show_symbol = null;
              $scope.actions.wrong.push({
                word: $scope.card.base_word.root_word,
                clicked: item.base_word.root_word})
            }, 1500)};
      }
    };
    }
    
</script>
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.0/angular.js"></script>
   <script src="./media/jquery.min.js"></script>
    <script src="./media/carousel.js"></script>



</body></html>